'use client'

import { useState } from 'react'

type Terrain = {
  id: number
  nom: string
  type: 'IntÃ©rieur' | 'ExtÃ©rieur'
  statut: 'Disponible' | 'En maintenance' | 'OccupÃ©'
  derniereMaintenance: string
}

type Reservation = {
  id: number
  terrainId: number
  client: string
  date: string
  heureDebut: string
  heureFin: string
  statut: 'ConfirmÃ©e' | 'En attente' | 'AnnulÃ©e'
  prix: number
}

type Evenement = {
  id: number
  nom: string
  type: 'Tournoi' | 'Stage' | 'Ã‰vÃ©nement'
  date: string
  heureDebut: string
  heureFin: string
  terrains: number[]
  participants: number
  statut: 'PlanifiÃ©' | 'En cours' | 'TerminÃ©'
}

export default function ExploitationPage() {
  const [selectedDate, setSelectedDate] = useState('2025-01-20')
  const [selectedTab, setSelectedTab] = useState<'terrains' | 'reservations' | 'evenements'>('terrains')

  const [terrains] = useState<Terrain[]>([
    { id: 1, nom: 'Terrain 1', type: 'IntÃ©rieur', statut: 'Disponible', derniereMaintenance: '2025-01-15' },
    { id: 2, nom: 'Terrain 2', type: 'IntÃ©rieur', statut: 'OccupÃ©', derniereMaintenance: '2025-01-10' },
    { id: 3, nom: 'Terrain 3', type: 'ExtÃ©rieur', statut: 'Disponible', derniereMaintenance: '2025-01-18' },
    { id: 4, nom: 'Terrain 4', type: 'ExtÃ©rieur', statut: 'En maintenance', derniereMaintenance: '2025-01-19' },
    { id: 5, nom: 'Terrain 5', type: 'IntÃ©rieur', statut: 'Disponible', derniereMaintenance: '2025-01-12' },
    { id: 6, nom: 'Terrain 6', type: 'ExtÃ©rieur', statut: 'Disponible', derniereMaintenance: '2025-01-16' },
  ])

  const [reservations] = useState<Reservation[]>([
    { id: 1, terrainId: 1, client: 'Jean Dupont', date: '2025-01-20', heureDebut: '09:00', heureFin: '10:30', statut: 'ConfirmÃ©e', prix: 45 },
    { id: 2, terrainId: 2, client: 'Marie Martin', date: '2025-01-20', heureDebut: '10:00', heureFin: '11:30', statut: 'ConfirmÃ©e', prix: 45 },
    { id: 3, terrainId: 1, client: 'Pierre Durand', date: '2025-01-20', heureDebut: '14:00', heureFin: '15:30', statut: 'En attente', prix: 40 },
    { id: 4, terrainId: 3, client: 'Sophie Bernard', date: '2025-01-20', heureDebut: '16:00', heureFin: '17:30', statut: 'ConfirmÃ©e', prix: 40 },
    { id: 5, terrainId: 5, client: 'Luc Petit', date: '2025-01-20', heureDebut: '18:00', heureFin: '19:30', statut: 'ConfirmÃ©e', prix: 50 },
    { id: 6, terrainId: 1, client: 'Emma Dubois', date: '2025-01-21', heureDebut: '10:00', heureFin: '11:30', statut: 'ConfirmÃ©e', prix: 45 },
    { id: 7, terrainId: 2, client: 'Thomas Roux', date: '2025-01-21', heureDebut: '14:00', heureFin: '15:30', statut: 'ConfirmÃ©e', prix: 45 },
  ])

  const [evenements] = useState<Evenement[]>([
    { id: 1, nom: 'Tournoi Open Janvier', type: 'Tournoi', date: '2025-01-25', heureDebut: '09:00', heureFin: '18:00', terrains: [1, 2, 3], participants: 16, statut: 'PlanifiÃ©' },
    { id: 2, nom: 'Stage DÃ©butants', type: 'Stage', date: '2025-01-22', heureDebut: '14:00', heureFin: '16:00', terrains: [4], participants: 8, statut: 'PlanifiÃ©' },
    { id: 3, nom: 'SoirÃ©e Padel', type: 'Ã‰vÃ©nement', date: '2025-01-26', heureDebut: '19:00', heureFin: '23:00', terrains: [1, 2, 3, 4, 5, 6], participants: 40, statut: 'PlanifiÃ©' },
  ])

  const reservationsDuJour = reservations.filter(r => r.date === selectedDate)

  const getStatutColor = (statut: string) => {
    switch (statut) {
      case 'Disponible':
      case 'ConfirmÃ©e':
      case 'PlanifiÃ©':
        return 'bg-green-100 text-green-800 border-green-200'
      case 'En maintenance':
      case 'En attente':
      case 'En cours':
        return 'bg-yellow-100 text-yellow-800 border-yellow-200'
      case 'OccupÃ©':
      case 'AnnulÃ©e':
        return 'bg-red-100 text-red-800 border-red-200'
      case 'TerminÃ©':
        return 'bg-gray-100 text-gray-800 border-gray-200'
      default:
        return 'bg-gray-100 text-gray-800 border-gray-200'
    }
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-3xl font-bold text-slate-900">Exploitation</h1>
          <p className="text-slate-600 mt-1">Gestion des terrains, rÃ©servations et Ã©vÃ©nements</p>
        </div>
        <button className="px-6 py-3 bg-gradient-to-r from-slate-700 to-slate-600 text-white rounded-lg font-semibold hover:from-slate-800 hover:to-slate-700 transition-all shadow-lg">
          + Nouvelle rÃ©servation
        </button>
      </div>

      {/* Tabs */}
      <div className="flex gap-2 border-b-2 border-slate-200">
        <button
          onClick={() => setSelectedTab('terrains')}
          className={`px-6 py-3 font-semibold transition-all ${
            selectedTab === 'terrains'
              ? 'text-slate-900 border-b-4 border-slate-900 -mb-0.5'
              : 'text-slate-500 hover:text-slate-700'
          }`}
        >
          ğŸŸï¸ Terrains
        </button>
        <button
          onClick={() => setSelectedTab('reservations')}
          className={`px-6 py-3 font-semibold transition-all ${
            selectedTab === 'reservations'
              ? 'text-slate-900 border-b-4 border-slate-900 -mb-0.5'
              : 'text-slate-500 hover:text-slate-700'
          }`}
        >
          ğŸ“… RÃ©servations
        </button>
        <button
          onClick={() => setSelectedTab('evenements')}
          className={`px-6 py-3 font-semibold transition-all ${
            selectedTab === 'evenements'
              ? 'text-slate-900 border-b-4 border-slate-900 -mb-0.5'
              : 'text-slate-500 hover:text-slate-700'
          }`}
        >
          ğŸ† Ã‰vÃ©nements & Tournois
        </button>
      </div>

      {/* Content */}
      {selectedTab === 'terrains' && (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {terrains.map((terrain) => (
            <div key={terrain.id} className="bg-white border-2 border-slate-200 rounded-xl p-6 hover:shadow-xl transition-all">
              <div className="flex items-start justify-between mb-4">
                <div>
                  <h3 className="text-xl font-bold text-slate-900">{terrain.nom}</h3>
                  <p className="text-sm text-slate-600 mt-1">{terrain.type}</p>
                </div>
                <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${getStatutColor(terrain.statut)}`}>
                  {terrain.statut}
                </span>
              </div>

              <div className="space-y-3 mb-4">
                <div className="flex justify-between text-sm">
                  <span className="text-slate-600">DerniÃ¨re maintenance :</span>
                  <span className="font-semibold text-slate-900">{terrain.derniereMaintenance}</span>
                </div>
                <div className="flex justify-between text-sm">
                  <span className="text-slate-600">RÃ©servations aujourd&apos;hui :</span>
                  <span className="font-semibold text-slate-900">
                    {reservations.filter(r => r.terrainId === terrain.id && r.date === selectedDate).length}
                  </span>
                </div>
              </div>

              <div className="flex gap-2">
                <button className="flex-1 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-900 rounded-lg font-medium transition-all">
                  Voir planning
                </button>
                <button className="px-4 py-2 bg-slate-700 hover:bg-slate-800 text-white rounded-lg font-medium transition-all">
                  âš™ï¸
                </button>
              </div>
            </div>
          ))}
        </div>
      )}

      {selectedTab === 'reservations' && (
        <div className="space-y-6">
          {/* Date Selector */}
          <div className="flex items-center gap-4 bg-white border-2 border-slate-200 rounded-xl p-4">
            <label className="font-semibold text-slate-900">Date :</label>
            <input
              type="date"
              value={selectedDate}
              onChange={(e) => setSelectedDate(e.target.value)}
              className="px-4 py-2 border-2 border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-transparent outline-none"
            />
            <div className="flex-1" />
            <div className="text-right">
              <p className="text-sm text-slate-600">Total rÃ©servations</p>
              <p className="text-2xl font-bold text-slate-900">{reservationsDuJour.length}</p>
            </div>
            <div className="text-right">
              <p className="text-sm text-slate-600">Revenus estimÃ©s</p>
              <p className="text-2xl font-bold text-green-600">
                {reservationsDuJour.reduce((acc, r) => acc + r.prix, 0)}â‚¬
              </p>
            </div>
          </div>

          {/* Reservations List */}
          <div className="bg-white border-2 border-slate-200 rounded-xl overflow-hidden">
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead className="bg-slate-100">
                  <tr>
                    <th className="px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider">Terrain</th>
                    <th className="px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider">Client</th>
                    <th className="px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider">Horaire</th>
                    <th className="px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider">Statut</th>
                    <th className="px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider">Prix</th>
                    <th className="px-6 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider">Actions</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-slate-200">
                  {reservationsDuJour.length === 0 ? (
                    <tr>
                      <td colSpan={6} className="px-6 py-8 text-center text-slate-500">
                        Aucune rÃ©servation pour cette date
                      </td>
                    </tr>
                  ) : (
                    reservationsDuJour.map((reservation) => {
                      const terrain = terrains.find(t => t.id === reservation.terrainId)
                      return (
                        <tr key={reservation.id} className="hover:bg-slate-50">
                          <td className="px-6 py-4">
                            <span className="font-semibold text-slate-900">{terrain?.nom}</span>
                          </td>
                          <td className="px-6 py-4 text-slate-900">{reservation.client}</td>
                          <td className="px-6 py-4 text-slate-900">
                            {reservation.heureDebut} - {reservation.heureFin}
                          </td>
                          <td className="px-6 py-4">
                            <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${getStatutColor(reservation.statut)}`}>
                              {reservation.statut}
                            </span>
                          </td>
                          <td className="px-6 py-4">
                            <span className="font-bold text-slate-900">{reservation.prix}â‚¬</span>
                          </td>
                          <td className="px-6 py-4">
                            <div className="flex gap-2">
                              <button className="px-3 py-1 bg-slate-100 hover:bg-slate-200 text-slate-900 rounded text-sm font-medium">
                                Modifier
                              </button>
                              <button className="px-3 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-sm font-medium">
                                Annuler
                              </button>
                            </div>
                          </td>
                        </tr>
                      )
                    })
                  )}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      )}

      {selectedTab === 'evenements' && (
        <div className="space-y-6">
          <div className="flex justify-end">
            <button className="px-6 py-3 bg-gradient-to-r from-slate-700 to-slate-600 text-white rounded-lg font-semibold hover:from-slate-800 hover:to-slate-700 transition-all shadow-lg">
              + CrÃ©er un Ã©vÃ©nement
            </button>
          </div>

          <div className="grid grid-cols-1 gap-6">
            {evenements.map((evenement) => (
              <div key={evenement.id} className="bg-white border-2 border-slate-200 rounded-xl p-6 hover:shadow-xl transition-all">
                <div className="flex items-start justify-between mb-4">
                  <div>
                    <div className="flex items-center gap-3 mb-2">
                      <h3 className="text-2xl font-bold text-slate-900">{evenement.nom}</h3>
                      <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${
                        evenement.type === 'Tournoi' ? 'bg-yellow-100 text-yellow-800 border-yellow-200' :
                        evenement.type === 'Stage' ? 'bg-blue-100 text-blue-800 border-blue-200' :
                        'bg-purple-100 text-purple-800 border-purple-200'
                      }`}>
                        {evenement.type}
                      </span>
                    </div>
                    <p className="text-slate-600">
                      ğŸ“… {evenement.date} â€¢ â° {evenement.heureDebut} - {evenement.heureFin}
                    </p>
                  </div>
                  <span className={`px-4 py-2 rounded-lg text-sm font-semibold border-2 ${getStatutColor(evenement.statut)}`}>
                    {evenement.statut}
                  </span>
                </div>

                <div className="grid grid-cols-3 gap-4 mb-4">
                  <div className="bg-slate-50 rounded-lg p-4">
                    <p className="text-sm text-slate-600 mb-1">Terrains utilisÃ©s</p>
                    <p className="text-2xl font-bold text-slate-900">{evenement.terrains.length}</p>
                    <p className="text-xs text-slate-500 mt-1">
                      {evenement.terrains.map(id => `T${id}`).join(', ')}
                    </p>
                  </div>
                  <div className="bg-slate-50 rounded-lg p-4">
                    <p className="text-sm text-slate-600 mb-1">Participants</p>
                    <p className="text-2xl font-bold text-slate-900">{evenement.participants}</p>
                    <p className="text-xs text-slate-500 mt-1">Inscrits</p>
                  </div>
                  <div className="bg-slate-50 rounded-lg p-4">
                    <p className="text-sm text-slate-600 mb-1">DurÃ©e</p>
                    <p className="text-2xl font-bold text-slate-900">
                      {parseInt(evenement.heureFin) - parseInt(evenement.heureDebut)}h
                    </p>
                    <p className="text-xs text-slate-500 mt-1">Totale</p>
                  </div>
                </div>

                <div className="flex gap-3">
                  <button className="flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-800 text-white rounded-lg font-medium transition-all">
                    Voir dÃ©tails
                  </button>
                  <button className="px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-900 rounded-lg font-medium transition-all">
                    Modifier
                  </button>
                  <button className="px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg font-medium transition-all">
                    Annuler
                  </button>
                </div>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  )
}
